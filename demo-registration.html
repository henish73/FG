<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üíô Book Your FREE Demo Class | FRENCH.GTA</title>
    <meta name="description" content="Book your free French demo class instantly. Choose from available time slots and start your French learning journey with FRENCH.GTA today.">
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" href="img/french.gta logo.jpg" type="image/x-icon">
    <script src="script.js" defer></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div id="header-placeholder"></div>

    <main class="main-content">
        <!-- Hero Section -->
        <section class="booking-hero">
            <div class="hero-content">
                <h1>üíô Book Your FREE Demo Class</h1>
                <p class="hero-subtitle">Choose a time that works for you and meet your French instructor</p>
                
                <div class="demo-benefits-quick">
                    <div class="benefit-item">
                        <i class="fas fa-heart"></i>
                        <span>Meet your caring instructor</span>
                    </div>
                    <div class="benefit-item">
                        <i class="fas fa-clock"></i>
                        <span>1-hour session</span>
                    </div>
                    <div class="benefit-item">
                        <i class="fab fa-google"></i>
                        <span>Online via Google Meet</span>
                    </div>
                    <div class="benefit-item">
                        <i class="fas fa-gift"></i>
                        <span>Completely FREE</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Booking Interface -->
        <section class="booking-interface">
            <div class="booking-container">
                <!-- Calendar Section -->
                <div class="calendar-section">
                    <div class="calendar-header">
                        <h3>üìÖ Choose Your Preferred Date</h3>
                        <div class="month-navigation">
                            <button id="prevMonth" class="nav-btn">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            <span id="currentMonth" class="month-display"></span>
                            <button id="nextMonth" class="nav-btn">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="calendar-grid" id="calendarGrid">
                        <!-- Calendar days will be generated by JavaScript -->
                    </div>
                </div>

                <!-- Time Slots Section -->
                <div class="timeslots-section">
                    <div class="timeslots-header">
                        <h3>‚è∞ Available Time Slots</h3>
                        <p id="selectedDateDisplay">Please select a date first</p>
                    </div>
                    
                    <div class="timeslots-grid" id="timeSlotsGrid">
                        <div class="no-date-selected">
                            <i class="fas fa-calendar-alt"></i>
                            <p>Select a date to see available times</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Booking Form -->
        <section class="booking-form-section" id="bookingFormSection" style="display: none;">
            <div class="form-container">
                <h3>üìù Almost There! Just a Few Details</h3>
                <div class="selected-slot-display" id="selectedSlotDisplay"></div>
                
                <form id="demoBookingForm" class="booking-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="firstName">First Name</label>
                            <input type="text" id="firstName" name="firstName" placeholder="Your first name" required>
                        </div>
                        <div class="form-group">
                            <label for="lastName">Last Name</label>
                            <input type="text" id="lastName" name="lastName" placeholder="Your last name" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="email">Email Address</label>
                        <input type="email" id="email" name="email" placeholder="we'll send your confirmation here" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="frenchLevel">Your French Level</label>
                        <select id="frenchLevel" name="frenchLevel" required>
                            <option value="">Please select your level</option>
                            <option value="complete-beginner">Complete Beginner - I'm just starting</option>
                            <option value="false-beginner">False Beginner - I know a little</option>
                            <option value="elementary">Elementary - I can say basic things</option>
                            <option value="intermediate">Intermediate - I can have simple conversations</option>
                            <option value="advanced">Advanced - I'm quite comfortable</option>
                            <option value="not-sure">Not sure - let's figure it out together!</option>
                        </select>
                    </div>
                    
                    <div class="form-actions">
                        <button type="button" id="backToSlots" class="btn-secondary">
                            <i class="fas fa-arrow-left"></i> Change Time
                        </button>
                        <button type="submit" class="cta-button">
                            <i class="fas fa-calendar-check"></i> Confirm My Demo Class
                        </button>
                    </div>
                </form>
            </div>
        </section>

        <!-- Confirmation Section -->
        <section class="confirmation-section" id="confirmationSection" style="display: none;">
            <div class="confirmation-container">
                <div class="confirmation-icon">
                    <i class="fas fa-check-circle"></i>
                </div>
                <h2>üéâ Demo Class Booked Successfully!</h2>
                <div class="confirmation-details" id="confirmationDetails"></div>
                
                <div class="next-steps">
                    <h3>üíù What Happens Next:</h3>
                    <ul class="next-steps-list">
                        <li><i class="fas fa-envelope"></i> You'll receive a confirmation email with Google Meet details</li>
                        <li><i class="fas fa-calendar"></i> Add this appointment to your calendar</li>
                        <li><i class="fas fa-heart"></i> We'll send a friendly reminder 1 day before</li>
                        <li><i class="fab fa-google"></i> Join the Google Meet call at your scheduled time</li>
                    </ul>
                </div>
                
                <div class="email-section">
                    <h3>üìß Send Confirmation Email</h3>
                    <p>Click below to send yourself a professional confirmation email with all the details:</p>
                    <button id="sendEmailBtn" class="cta-button">
                        <i class="fas fa-paper-plane"></i> Send Confirmation Email
                    </button>
                </div>
                
                <div class="whatsapp-booking-section">
                    <h3>üì± Instant Confirmation via WhatsApp</h3>
                    <p>For immediate confirmation and to ensure we receive your booking, click below to send your booking details directly to our WhatsApp:</p>
                    <button id="sendWhatsAppBooking" class="cta-button whatsapp-btn" style="background: #25d366; margin: 1rem 0;">
                        <i class="fab fa-whatsapp"></i> Send Booking to WhatsApp
                    </button>
                </div>
                
                <div class="confirmation-actions">
                    <a href="services.html" class="cta-button">
                        <i class="fas fa-compass"></i> Explore Our Programs
                    </a>
                    <button onclick="bookAnotherDemo()" class="btn-secondary">
                        <i class="fas fa-plus"></i> Book Another Demo
                    </button>
                </div>
            </div>
        </section>
    </main>

    <div id="footer-placeholder"></div>

    <script>
        const monthNames = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
        const dayNames = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"];
        const calendarEl = document.getElementById('calendar');
        const monthYearEl = document.getElementById('monthYear');
        const timeSlotsEl = document.getElementById('timeSlots');
        const availableSlots = { // Admin defines available slots here (YYYY-MM-DD: [HH:MM, HH:MM])
            // Example: "2024-03-15": ["10:00", "14:00", "18:00"], (Add more dates and times)
            // THIS IS THE DEMO DATA - REPLACE WITH ACTUALS
            "2025-06-10": ["09:00", "10:30", "15:00"],
            "2025-06-11": ["10:00", "11:30", "14:00", "16:30"],
            "2025-06-03": ["09:00", "10:30", "15:00"],
            "2025-06-04": ["10:00", "14:00"],
            "2025-06-05": ["11:00", "15:30"],
            "2025-06-06": ["10:00", "11:30", "14:00", "16:30", "18:00"]
            // Ensure dates are in the future and times are reasonable for demo classes
        };
        const ADMIN_EMAIL = 'frenchgta.ca@gmail.com';
        const GOOGLE_MEET_LINK = 'https://meet.google.com/your-demo-link'; // ADMIN: Update this link!

        let currentMonth, currentYear;
        let selectedDate = null;
        let selectedTime = null;
        let bookingData = null; // To store name, email, etc.

        function generateCalendar(month, year) {
            const calendarGrid = document.getElementById('calendarGrid');
            const currentMonth = document.getElementById('currentMonth');
            
            if (!calendarGrid || !currentMonth) {
                console.error('Calendar elements not found');
                return;
            }
            
            calendarGrid.innerHTML = ''; // Clear previous calendar
            currentMonth.textContent = `${monthNames[month]} ${year}`;

            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();

            // Add day headers (Sun, Mon, ...)
            dayNames.forEach(day => {
                const dayEl = document.createElement('div');
                dayEl.classList.add('calendar-day-header');
                dayEl.textContent = day;
                calendarGrid.appendChild(dayEl);
            });

            // Add empty cells for days before the first of the month
            for (let i = 0; i < firstDay; i++) {
                const emptyCell = document.createElement('div');
                emptyCell.classList.add('calendar-day', 'empty');
                calendarGrid.appendChild(emptyCell);
            }

            // Add day cells
            const today = new Date();
            today.setHours(0, 0, 0, 0); // Normalize today to midnight for comparison

            for (let day = 1; day <= daysInMonth; day++) {
                const dayCell = document.createElement('div');
                dayCell.classList.add('calendar-day');
                dayCell.textContent = day;
                const dateKey = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                const currentDate = new Date(year, month, day);
                currentDate.setHours(0,0,0,0); // Normalize current cell date

                if (availableSlots[dateKey] && availableSlots[dateKey].length > 0 && currentDate >= today) {
                    dayCell.classList.add('available');
                    dayCell.addEventListener('click', () => selectDate(dateKey, dayCell));
                } else if (currentDate < today) {
                    dayCell.classList.add('past');
                } else {
                    dayCell.classList.add('unavailable');
                }
                
                if (selectedDate === dateKey) {
                    dayCell.classList.add('selected');
                }
                calendarGrid.appendChild(dayCell);
            }
        }

        function prevMonth() {
            currentMonth--;
            if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            }
            generateCalendar(currentMonth, currentYear);
        }

        function nextMonth() {
            currentMonth++;
            if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            }
            generateCalendar(currentMonth, currentYear);
        }

        function selectDate(dateKey, dayCell) {
            selectedDate = dateKey;
            selectedTime = null; // Reset time selection
            document.querySelectorAll('.calendar-day.selected').forEach(cell => cell.classList.remove('selected'));
            dayCell.classList.add('selected');
            displayTimeSlots(dateKey);
            
            // Update the selected date display
            const selectedDateDisplay = document.getElementById('selectedDateDisplay');
            if (selectedDateDisplay) {
                const [year, month, day] = dateKey.split('-').map(Number);
                const dateDisplay = `${monthNames[month - 1]} ${day}, ${year}`;
                selectedDateDisplay.textContent = `Selected: ${dateDisplay}`;
            }
            
            // Hide form and confirmation if a new date is selected
            const bookingFormSection = document.getElementById('bookingFormSection');
            const confirmationSection = document.getElementById('confirmationSection');
            if (bookingFormSection) bookingFormSection.style.display = 'none';
            if (confirmationSection) confirmationSection.style.display = 'none';
        }

        function displayTimeSlots(dateKey) {
            const timeSlotsGrid = document.getElementById('timeSlotsGrid');
            if (!timeSlotsGrid) return;
            
            timeSlotsGrid.innerHTML = ''; // Clear previous time slots
            const slots = availableSlots[dateKey];
            
            if (!slots || slots.length === 0) {
                timeSlotsGrid.innerHTML = '<div class="no-slots"><i class="fas fa-clock"></i><p>No slots available for this date.</p></div>';
                return;
            }

            slots.forEach(time => {
                const slotButton = document.createElement('button');
                slotButton.classList.add('time-slot-button');
                slotButton.textContent = formatTimeForDisplay(time);
                slotButton.addEventListener('click', () => selectTime(time, slotButton));
                if (selectedTime === time) {
                    slotButton.classList.add('selected');
                }
                timeSlotsGrid.appendChild(slotButton);
            });
        }

        function formatTimeForDisplay(timeStr) { // timeStr is HH:MM
            const [hours, minutes] = timeStr.split(':').map(Number);
            const ampm = hours >= 12 ? 'PM' : 'AM';
            const displayHours = hours % 12 || 12; // Convert 0 to 12 for 12 AM/PM
            return `${displayHours}:${String(minutes).padStart(2, '0')} ${ampm} EST`;
        }

        function selectTime(time, slotButton) {
            selectedTime = time;
            document.querySelectorAll('.time-slot-button.selected').forEach(btn => btn.classList.remove('selected'));
            slotButton.classList.add('selected');
            
            // Update the selected slot display
            updateSelectedSlotDisplay();
            
            const bookingFormSection = document.getElementById('bookingFormSection');
            if (bookingFormSection) {
                bookingFormSection.style.display = 'block';
                bookingFormSection.scrollIntoView({ behavior: 'smooth' });
            }
        }

        function updateSelectedSlotDisplay() {
            const selectedSlotDisplay = document.getElementById('selectedSlotDisplay');
            if (selectedSlotDisplay && selectedDate && selectedTime) {
                const [year, month, day] = selectedDate.split('-').map(Number);
                const dateDisplay = `${monthNames[month - 1]} ${day}, ${year}`;
                const timeDisplay = formatTimeForDisplay(selectedTime);
                
                selectedSlotDisplay.innerHTML = `
                    <div class="selected-slot">
                        <div class="slot-icon">
                            <i class="fas fa-calendar-check"></i>
                        </div>
                        <div class="slot-details">
                            <strong>${dateDisplay}</strong><br>
                            <span style="color: var(--brand-primary);">${timeDisplay}</span><br>
                            <small style="color: var(--neutral-600);">1 hour demo session</small>
                        </div>
                    </div>
                `;
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            const today = new Date();
            currentMonth = today.getMonth();
            currentYear = today.getFullYear();
            generateCalendar(currentMonth, currentYear);

            // Set up month navigation
            const prevBtn = document.getElementById('prevMonth');
            const nextBtn = document.getElementById('nextMonth');
            
            if (prevBtn) {
                prevBtn.addEventListener('click', () => {
                    currentMonth--;
                    if (currentMonth < 0) {
                        currentMonth = 11;
                        currentYear--;
                    }
                    generateCalendar(currentMonth, currentYear);
                });
            }
            
            if (nextBtn) {
                nextBtn.addEventListener('click', () => {
                    currentMonth++;
                    if (currentMonth > 11) {
                        currentMonth = 0;
                        currentYear++;
                    }
                    generateCalendar(currentMonth, currentYear);
                });
            }

            // Set up back to slots button
            const backToSlotsBtn = document.getElementById('backToSlots');
            if (backToSlotsBtn) {
                backToSlotsBtn.addEventListener('click', () => {
                    const bookingFormSection = document.getElementById('bookingFormSection');
                    if (bookingFormSection) {
                        bookingFormSection.style.display = 'none';
                    }
                    // Scroll back to calendar
                    const bookingInterface = document.querySelector('.booking-interface');
                    if (bookingInterface) {
                        bookingInterface.scrollIntoView({ behavior: 'smooth' });
                    }
                });
            }

            const bookingForm = document.getElementById('demoBookingForm');
            if (bookingForm) {
                bookingForm.addEventListener('submit', function(event) {
                    event.preventDefault();
                    if (!selectedDate || !selectedTime) {
                        alert('Please select a date and time for your demo class.');
                        return;
                    }

                    bookingData = {
                        firstName: document.getElementById('firstName').value,
                        lastName: document.getElementById('lastName').value,
                        email: document.getElementById('email').value,
                        frenchLevel: document.getElementById('frenchLevel').value,
                        notes: document.getElementById('notes') ? document.getElementById('notes').value : '',
                        date: selectedDate,
                        time: selectedTime
                    };

                    displayConfirmationAndNotifyAdmin(bookingData);
                });
            }
        });

        function displayConfirmationAndNotifyAdmin(bookingData) {
            const confirmationSection = document.getElementById('confirmationSection');
            const bookingInterface = document.querySelector('.booking-interface');
            const bookingFormSection = document.getElementById('bookingFormSection');
            
            if (bookingInterface) bookingInterface.style.display = 'none';
            if (bookingFormSection) bookingFormSection.style.display = 'none';
            if (confirmationSection) confirmationSection.style.display = 'block';

            // Update confirmation display
            const confirmationContainer = confirmationSection.querySelector('.confirmation-container');
            if (confirmationContainer) {
                const [year, month, day] = bookingData.date.split('-').map(Number);
                const dateDisplay = `${monthNames[month - 1]} ${day}, ${year}`;
                const timeDisplay = formatTimeForDisplay(bookingData.time);
                
                confirmationContainer.innerHTML = `
                    <div class="confirmation-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <h2>Booking Confirmed!</h2>
                    <p>Thank you, ${bookingData.firstName}! Your demo class has been successfully booked.</p>
                    
                    <div class="booking-summary">
                        <h4>Your Demo Class Details</h4>
                        <div class="detail-item">
                            <i class="fas fa-user"></i>
                            <span><strong>Student:</strong> ${bookingData.firstName} ${bookingData.lastName}</span>
                        </div>
                        <div class="detail-item">
                            <i class="fas fa-calendar-alt"></i>
                            <span><strong>Date:</strong> ${dateDisplay}</span>
                        </div>
                        <div class="detail-item">
                            <i class="fas fa-clock"></i>
                            <span><strong>Time:</strong> ${timeDisplay}</span>
                        </div>
                        <div class="detail-item">
                            <i class="fas fa-graduation-cap"></i>
                            <span><strong>Level:</strong> ${bookingData.frenchLevel}</span>
                        </div>
                        <div class="detail-item">
                            <i class="fas fa-envelope"></i>
                            <span><strong>Email:</strong> ${bookingData.email}</span>
                        </div>
                    </div>

                    <div class="next-steps">
                        <h3>What Happens Next?</h3>
                        <ul class="next-steps-list">
                            <li>
                                <i class="fas fa-email"></i>
                                <span>You'll receive a confirmation email within 5 minutes</span>
                            </li>
                            <li>
                                <i class="fas fa-video"></i>
                                <span>We'll send you the meeting link 24 hours before your session</span>
                            </li>
                            <li>
                                <i class="fas fa-phone"></i>
                                <span>Our team may contact you to confirm details</span>
                            </li>
                            <li>
                                <i class="fas fa-heart"></i>
                                <span>Get ready for an amazing French learning experience!</span>
                            </li>
                        </ul>
                    </div>

                    <div class="whatsapp-booking-section">
                        <h3>üì± Instant Confirmation via WhatsApp</h3>
                        <p>For immediate confirmation and to ensure we receive your booking, click below to send your booking details directly to our WhatsApp:</p>
                        <button id="sendWhatsAppBooking" class="cta-button whatsapp-btn" style="background: #25d366; margin: 1rem 0;">
                            <i class="fab fa-whatsapp"></i> Send Booking to WhatsApp
                        </button>
                    </div>

                    <div class="confirmation-actions">
                        <button onclick="bookAnotherDemo()" class="cta-button cta-button-secondary">
                            <i class="fas fa-plus"></i> Book Another Demo
                        </button>
                        <a href="services.html" class="cta-button">
                            <i class="fas fa-graduation-cap"></i> Explore Our Courses
                        </a>
                    </div>
                `;
            }

            // Submit to PHP backend
            const formData = new FormData();
            formData.append('firstName', bookingData.firstName);
            formData.append('lastName', bookingData.lastName);
            formData.append('email', bookingData.email);
            formData.append('frenchLevel', bookingData.frenchLevel);
            formData.append('notes', bookingData.notes || '');
            formData.append('date', bookingData.date);
            formData.append('time', bookingData.time);

            fetch('submit_demo_booking.php', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                console.log('Booking submission result:', data);
                if (data.status === 'success') {
                    // Add success indicator to confirmation
                    const successIndicator = document.createElement('div');
                    successIndicator.className = 'success-indicator';
                    successIndicator.innerHTML = `
                        <div style="background: var(--brand-accent); color: white; padding: 1rem; border-radius: var(--radius-lg); margin: 1rem 0; text-align: center;">
                            <i class="fas fa-check-double"></i> Booking confirmed and admin notified!
                        </div>
                    `;
                    confirmationContainer.appendChild(successIndicator);
                } else {
                    // Add warning indicator
                    const warningIndicator = document.createElement('div');
                    warningIndicator.className = 'warning-indicator';
                    warningIndicator.innerHTML = `
                        <div style="background: var(--brand-warning); color: white; padding: 1rem; border-radius: var(--radius-lg); margin: 1rem 0; text-align: center;">
                            <i class="fas fa-exclamation-triangle"></i> Booking saved but please also contact us directly at frenchgta.ca@gmail.com
                        </div>
                    `;
                    confirmationContainer.appendChild(warningIndicator);
                }
            })
            .catch(error => {
                console.error('Error submitting booking:', error);
                // Add error indicator but don't break the user experience
                const errorIndicator = document.createElement('div');
                errorIndicator.className = 'error-indicator';
                errorIndicator.innerHTML = `
                    <div style="background: var(--brand-danger); color: white; padding: 1rem; border-radius: var(--radius-lg); margin: 1rem 0; text-align: center;">
                        <i class="fas fa-exclamation-circle"></i> Please also email us at frenchgta.ca@gmail.com to confirm your booking
                    </div>
                `;
                confirmationContainer.appendChild(errorIndicator);
            });

            // Scroll to confirmation
            confirmationSection.scrollIntoView({ behavior: 'smooth' });

            // Add WhatsApp button functionality
            const sendWhatsAppBtn = document.getElementById('sendWhatsAppBooking');
            if (sendWhatsAppBtn) {
                sendWhatsAppBtn.addEventListener('click', function() {
                    if (typeof sendDemoBookingToWhatsApp === 'function') {
                        sendDemoBookingToWhatsApp(bookingData);
                    } else {
                        // Fallback if function not loaded
                        const message = `üéØ NEW DEMO CLASS BOOKING\n\nüë§ Student: ${bookingData.firstName} ${bookingData.lastName}\nüìß Email: ${bookingData.email}\nüìÖ Date: ${bookingData.date}\n‚è∞ Time: ${bookingData.time}\nüéì French Level: ${bookingData.frenchLevel}`;
                        const phoneNumber = "+13653062049";
                        const whatsappURL = `https://wa.me/${phoneNumber}?text=${encodeURIComponent(message)}`;
                        window.open(whatsappURL, '_blank');
                    }
                });
            }
        }

        function bookAnotherDemo() {
            // Reset UI to initial state
            const confirmationSection = document.getElementById('confirmationSection');
            const bookingInterface = document.querySelector('.booking-interface');
            const timeSlotsGrid = document.getElementById('timeSlotsGrid');
            const bookingFormSection = document.getElementById('bookingFormSection');
            
            if (confirmationSection) confirmationSection.style.display = 'none';
            if (bookingInterface) bookingInterface.style.display = 'block';
            if (timeSlotsGrid) timeSlotsGrid.innerHTML = '<div class="no-date-selected"><i class="fas fa-calendar-alt"></i><p>Select a date to see available times</p></div>';
            if (bookingFormSection) bookingFormSection.style.display = 'none';
            
            // Reset selections
            selectedDate = null;
            selectedTime = null;
            
            // Regenerate calendar to clear selection and show current month
            const today = new Date();
            currentMonth = today.getMonth();
            currentYear = today.getFullYear();
            generateCalendar(currentMonth, currentYear);

            // Scroll to calendar
            if (bookingInterface) {
                bookingInterface.scrollIntoView({ behavior: 'smooth' });
            }
        }
    </script>
</body>
</html> 