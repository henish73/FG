<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéì Course Registration | FRENCH.GTA</title>
    <meta name="description" content="Register for French courses at FRENCH.GTA. Choose your program, payment method (PayPal or Interac), and start your French learning journey today.">
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" href="img/french.gta logo.jpg" type="image/x-icon">
    <script src="script.js" defer></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div id="header-placeholder"></div>

    <main class="main-content">
        <!-- Hero Section -->
        <section class="registration-hero">
            <div class="hero-content">
                <h1>üéì Course Registration</h1>
                <p class="hero-subtitle">Complete your registration and start your French learning journey</p>
                
                <div class="registration-benefits">
                    <div class="benefit-item">
                        <i class="fas fa-shield-check"></i>
                        <span>Secure Payment</span>
                    </div>
                    <div class="benefit-item">
                        <i class="fas fa-calendar-check"></i>
                        <span>Instant Access</span>
                    </div>
                    <div class="benefit-item">
                        <i class="fas fa-graduation-cap"></i>
                        <span>Expert Instructors</span>
                    </div>
                    <div class="benefit-item">
                        <i class="fas fa-heart"></i>
                        <span>Personal Support</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Registration Form -->
        <section class="registration-form-section">
            <div class="form-container">
                <form id="courseRegistrationForm" class="registration-form">
                    
                    <!-- Step 1: Course Selection -->
                    <div class="form-step active" id="step1">
                        <div class="step-header">
                            <h2><span class="step-number">1</span> Choose Your Course</h2>
                            <p>Select the French program that best fits your goals</p>
                        </div>

                        <div class="course-selection-grid">
                            <!-- Group Learning Plan -->
                            <div class="course-option" data-course="group-learning" data-price="249" data-original="399">
                                <div class="course-badge popular-badge">‚≠ê MOST POPULAR</div>
                                <h3>Group Learning</h3>
                                <div class="course-subtitle">Perfect for Steady Progress</div>
                                <div class="price-display">
                                    <div class="original-price">CAD $399</div>
                                    <div class="current-price">CAD $249<span>/month</span></div>
                                    <div class="savings-badge">Save $150!</div>
                                </div>
                                <div class="course-details">
                                    <p>5 Days/Week ‚Ä¢ 20 Classes ‚Ä¢ Small Groups (Max 3)</p>
                                    <ul class="feature-list">
                                        <li><i class="fas fa-check"></i> Expert instructors</li>
                                        <li><i class="fas fa-check"></i> Study materials included</li>
                                        <li><i class="fas fa-check"></i> Flexible rescheduling</li>
                                        <li><i class="fas fa-check"></i> Progress tracking</li>
                                    </ul>
                                </div>
                                <div class="select-course-btn">
                                    <button type="button" class="cta-button">Select This Course</button>
                                </div>
                            </div>

                            <!-- Flexible Learning Plan -->
                            <div class="course-option" data-course="flexible-learning" data-price="179" data-original="299">
                                <div class="course-badge value-badge">üíé GREAT VALUE</div>
                                <h3>Flexible Learning</h3>
                                <div class="course-subtitle">Steady & Manageable</div>
                                <div class="price-display">
                                    <div class="original-price">CAD $299</div>
                                    <div class="current-price">CAD $179<span>/month</span></div>
                                    <div class="savings-badge">Save $120!</div>
                                </div>
                                <div class="course-details">
                                    <p>3 Days/Week ‚Ä¢ 12 Classes ‚Ä¢ Small Groups (Max 3)</p>
                                    <ul class="feature-list">
                                        <li><i class="fas fa-check"></i> 12 live classes per month</li>
                                        <li><i class="fas fa-check"></i> All materials included</li>
                                        <li><i class="fas fa-check"></i> Flexible rescheduling</li>
                                        <li><i class="fas fa-check"></i> Progress tracking</li>
                                    </ul>
                                </div>
                                <div class="select-course-btn">
                                    <button type="button" class="cta-button">Select This Course</button>
                                </div>
                            </div>

                            <!-- One-on-One Intensive -->
                            <div class="course-option" data-course="one-on-one-intensive" data-price="399" data-original="599">
                                <div class="course-badge premium-badge">‚ú® PERSONALIZED</div>
                                <h3>One-on-One Intensive</h3>
                                <div class="course-subtitle">Maximum Personal Attention</div>
                                <div class="price-display">
                                    <div class="original-price">CAD $599</div>
                                    <div class="current-price">CAD $399<span>/month</span></div>
                                    <div class="savings-badge">Save $200!</div>
                                </div>
                                <div class="course-details">
                                    <p>5 Days/Week ‚Ä¢ 20 Private Sessions</p>
                                    <ul class="feature-list">
                                        <li><i class="fas fa-star"></i> 20 private 1:1 sessions</li>
                                        <li><i class="fas fa-star"></i> Customized learning plan</li>
                                        <li><i class="fas fa-star"></i> TEF/DELF preparation</li>
                                        <li><i class="fas fa-star"></i> Weekly progress reports</li>
                                    </ul>
                                </div>
                                <div class="select-course-btn">
                                    <button type="button" class="cta-button cta-premium">Select This Course</button>
                                </div>
                            </div>

                            <!-- Personal Learning -->
                            <div class="course-option" data-course="personal-learning" data-price="349" data-original="499">
                                <h3>Personal Learning</h3>
                                <div class="course-subtitle">Individual Focus</div>
                                <div class="price-display">
                                    <div class="original-price">CAD $499</div>
                                    <div class="current-price">CAD $349<span>/month</span></div>
                                    <div class="savings-badge">Save $150!</div>
                                </div>
                                <div class="course-details">
                                    <p>3 Days/Week ‚Ä¢ 12 Private Sessions</p>
                                    <ul class="feature-list">
                                        <li><i class="fas fa-check"></i> 12 private 1:1 sessions</li>
                                        <li><i class="fas fa-check"></i> Customized approach</li>
                                        <li><i class="fas fa-check"></i> Flexible scheduling</li>
                                        <li><i class="fas fa-check"></i> Personal progress tracking</li>
                                    </ul>
                                </div>
                                <div class="select-course-btn">
                                    <button type="button" class="cta-button">Select This Course</button>
                                </div>
                            </div>
                        </div>

                        <div class="step-actions">
                            <button type="button" id="continueToStep2" class="cta-button large" disabled>
                                Continue to Personal Details <i class="fas fa-arrow-right"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Step 2: Personal Information -->
                    <div class="form-step" id="step2">
                        <div class="step-header">
                            <h2><span class="step-number">2</span> Personal Information</h2>
                            <p>Tell us about yourself so we can personalize your learning experience</p>
                        </div>

                        <div class="selected-course-summary" id="selectedCourseSummary">
                            <!-- Will be populated by JavaScript -->
                        </div>

                        <div class="form-grid">
                            <div class="form-group">
                                <label for="firstName"><i class="fas fa-user"></i> First Name *</label>
                                <input type="text" id="firstName" name="firstName" placeholder="Your first name" required>
                            </div>

                            <div class="form-group">
                                <label for="lastName"><i class="fas fa-user"></i> Last Name *</label>
                                <input type="text" id="lastName" name="lastName" placeholder="Your last name" required>
                            </div>

                            <div class="form-group">
                                <label for="email"><i class="fas fa-envelope"></i> Email Address *</label>
                                <input type="email" id="email" name="email" placeholder="your.email@example.com" required>
                            </div>

                            <div class="form-group">
                                <label for="phone"><i class="fas fa-phone"></i> Phone Number *</label>
                                <input type="tel" id="phone" name="phone" placeholder="+1 (555) 123-4567" required>
                            </div>

                            <div class="form-group full-width">
                                <label for="frenchLevel"><i class="fas fa-chart-line"></i> Current French Level</label>
                                <select id="frenchLevel" name="frenchLevel" required>
                                    <option value="">Select your current level</option>
                                    <option value="complete-beginner">Complete Beginner (A0) - No French knowledge</option>
                                    <option value="a1">Elementary (A1) - Basic phrases and expressions</option>
                                    <option value="a2">Pre-Intermediate (A2) - Simple conversations</option>
                                    <option value="b1">Intermediate (B1) - Comfortable with basic topics</option>
                                    <option value="b2">Upper-Intermediate (B2) - Complex discussions</option>
                                    <option value="c1">Advanced (C1) - Fluent in most situations</option>
                                    <option value="c2">Proficient (C2) - Near-native level</option>
                                </select>
                            </div>

                            <div class="form-group full-width">
                                <label for="learningGoals"><i class="fas fa-target"></i> Learning Goals</label>
                                <select id="learningGoals" name="learningGoals" required>
                                    <option value="">What's your main goal?</option>
                                    <option value="immigration">Canadian Immigration (TEF/TCF)</option>
                                    <option value="work">Work and Career Advancement</option>
                                    <option value="travel">Travel and Cultural Interest</option>
                                    <option value="education">Academic Studies</option>
                                    <option value="family">Family Communication</option>
                                    <option value="personal">Personal Development</option>
                                </select>
                            </div>

                            <div class="form-group full-width">
                                <label for="timeline"><i class="fas fa-clock"></i> When would you like to start?</label>
                                <select id="timeline" name="timeline" required>
                                    <option value="">Select your preferred start time</option>
                                    <option value="immediately">Immediately - This week</option>
                                    <option value="next-week">Next week</option>
                                    <option value="within-month">Within this month</option>
                                    <option value="next-month">Next month</option>
                                    <option value="flexible">I'm flexible</option>
                                </select>
                            </div>

                            <div class="form-group full-width">
                                <label for="specialRequests"><i class="fas fa-comment"></i> Special Requests or Questions (Optional)</label>
                                <textarea id="specialRequests" name="specialRequests" rows="3" 
                                         placeholder="Any specific learning needs, schedule preferences, or questions you'd like to share..."></textarea>
                            </div>
                        </div>

                        <div class="step-actions">
                            <button type="button" id="backToStep1" class="btn-secondary">
                                <i class="fas fa-arrow-left"></i> Back to Course Selection
                            </button>
                            <button type="button" id="continueToStep3" class="cta-button large">
                                Continue to Payment <i class="fas fa-arrow-right"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Step 3: Payment Method -->
                    <div class="form-step" id="step3">
                        <div class="step-header">
                            <h2><span class="step-number">3</span> Choose Payment Method</h2>
                            <p>Select your preferred payment option to complete registration</p>
                        </div>

                        <div class="order-summary" id="orderSummary">
                            <!-- Will be populated by JavaScript -->
                        </div>

                        <div class="payment-methods">
                            <!-- PayPal Option -->
                            <div class="payment-option" data-method="paypal">
                                <div class="payment-header">
                                    <div class="payment-icon paypal-icon">
                                        <i class="fab fa-paypal"></i>
                                    </div>
                                    <div class="payment-info">
                                        <h3>Pay with PayPal</h3>
                                        <p>Secure payment with PayPal account or credit card</p>
                                    </div>
                                    <div class="payment-check">
                                        <input type="radio" name="paymentMethod" value="paypal" id="paypalOption">
                                        <label for="paypalOption"></label>
                                    </div>
                                </div>
                                <div class="payment-details" id="paypalDetails" style="display: none;">
                                    <div class="payment-benefits">
                                        <div class="benefit">
                                            <i class="fas fa-shield-check"></i>
                                            <span>100% Secure and Protected</span>
                                        </div>
                                        <div class="benefit">
                                            <i class="fas fa-user-check"></i>
                                            <span>Login with PayPal or pay as guest</span>
                                        </div>
                                        <div class="benefit">
                                            <i class="fas fa-credit-card"></i>
                                            <span>Credit cards, debit cards accepted</span>
                                        </div>
                                        <div class="benefit">
                                            <i class="fas fa-undo"></i>
                                            <span>Easy cancellation anytime</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Interac Option -->
                            <div class="payment-option" data-method="interac">
                                <div class="payment-header">
                                    <div class="payment-icon interac-icon">
                                        <i class="fas fa-university"></i>
                                    </div>
                                    <div class="payment-info">
                                        <h3>Interac e-Transfer</h3>
                                        <p>Direct bank transfer - Popular in Canada</p>
                                    </div>
                                    <div class="payment-check">
                                        <input type="radio" name="paymentMethod" value="interac" id="interacOption">
                                        <label for="interacOption"></label>
                                    </div>
                                </div>
                                <div class="payment-details" id="interacDetails" style="display: none;">
                                    <div class="interac-instructions">
                                        <div class="instruction-header">
                                            <h4>üìß e-Transfer Instructions</h4>
                                            <p>Send your payment using Interac e-Transfer with these details:</p>
                                        </div>
                                        <div class="transfer-info">
                                            <div class="info-item">
                                                <strong>Email:</strong> <span class="highlight">phenish125@gmail.com</span>
                                            </div>
                                            <div class="info-item">
                                                <strong>Amount:</strong> <span id="interacAmount" class="highlight">CAD $249</span>
                                            </div>
                                            <div class="info-item">
                                                <strong>Security Question:</strong> <span class="highlight">French Learning</span>
                                            </div>
                                            <div class="info-item">
                                                <strong>Answer:</strong> <span class="highlight">Success</span>
                                            </div>
                                            <div class="info-item">
                                                <strong>Message:</strong> <span class="highlight">[Your Course] - [Your Name]</span>
                                            </div>
                                        </div>
                                        <div class="interac-note">
                                            <i class="fas fa-info-circle"></i>
                                            <p>After sending the e-Transfer, complete your registration below. We'll confirm your payment and send course details within 24 hours.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="step-actions">
                            <button type="button" id="backToStep2" class="btn-secondary">
                                <i class="fas fa-arrow-left"></i> Back to Personal Info
                            </button>
                            <button type="button" id="completeRegistration" class="cta-button large" disabled>
                                <i class="fas fa-credit-card"></i> Complete Registration
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </section>

        <!-- Success Section -->
        <section class="success-section" id="successSection" style="display: none;">
            <div class="success-container">
                <div class="success-icon">
                    <i class="fas fa-check-circle"></i>
                </div>
                <h2>üéâ Registration Completed!</h2>
                <div id="successMessage">
                    <!-- Will be populated by JavaScript based on payment method -->
                </div>
                
                <div class="next-steps">
                    <h3>üìã What happens next:</h3>
                    <ul class="next-steps-list" id="nextStepsList">
                        <!-- Will be populated by JavaScript -->
                    </ul>
                </div>
                
                <div class="success-actions">
                    <a href="services.html" class="cta-button">
                        <i class="fas fa-compass"></i> View All Courses
                    </a>
                    <a href="demo-registration.html" class="btn-secondary">
                        <i class="fas fa-play-circle"></i> Book Free Demo
                    </a>
                </div>
            </div>
        </section>

        <!-- Single Demo CTA -->
        <div class="final-cta-section">
          <div class="cta-container">
            <h3>üåü Ready to Begin Your French Journey?</h3>
            <p class="cta-subtext">Join <strong>184+ students</strong> who chose FRENCH.GTA for their French learning</p>
            <div class="cta-buttons">
              <a href="course-registration.html" class="cta-button cta-primary large">
                <i class="fas fa-graduation-cap"></i> Register for Course Now
              </a>
              <a href="demo-registration.html" class="cta-button cta-secondary large">
                <i class="fas fa-play-circle"></i> Start with FREE Demo First
              </a>
              <div class="cta-note">
                <small>‚ú® Secure registration ‚Ä¢ ‚ú® Multiple payment options ‚Ä¢ ‚ú® Instant confirmation</small>
              </div>
            </div>
          </div>
        </div>
    </main>

    <!-- Floating WhatsApp Button -->
    <a href="https://wa.me/+13653062049?text=Hi%20FRENCH.GTA%2C%20Can%20i%20know%20more%20about%20it?" 
       target="_blank" class="floating-whatsapp-btn">
       <i class="fab fa-whatsapp"></i>
    </a>

    <div id="footer-placeholder"></div>

    <style>
      .floating-whatsapp-btn {
        position: fixed;
        bottom: 20px;
        right: 20px;
        background: #25D366;
        color: white !important;
        width: 60px;
        height: 60px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        text-decoration: none;
        box-shadow: 0 4px 20px rgba(37, 211, 102, 0.4);
        z-index: 9999;
        transition: all 0.3s ease;
        font-size: 1.5rem;
      }

      .floating-whatsapp-btn:hover {
        background: #128C7E;
        transform: scale(1.1);
        box-shadow: 0 6px 25px rgba(37, 211, 102, 0.6);
        color: white !important;
      }

      .floating-whatsapp-btn:before {
        content: '';
        position: absolute;
        width: 100%;
        height: 100%;
        border-radius: 50%;
        background: #25D366;
        animation: whatsapp-pulse 2s infinite;
        z-index: -1;
      }

      @keyframes whatsapp-pulse {
        0% {
          transform: scale(1);
          opacity: 1;
        }
        50% {
          transform: scale(1.2);
          opacity: 0.7;
        }
        100% {
          transform: scale(1.4);
          opacity: 0;
        }
      }

      @media (max-width: 768px) {
        .floating-whatsapp-btn {
          width: 50px;
          height: 50px;
          bottom: 15px;
          right: 15px;
          font-size: 1.2rem;
        }
      }

      @media (max-width: 480px) {
        .floating-whatsapp-btn {
          width: 45px;
          height: 45px;
          bottom: 10px;
          right: 10px;
          font-size: 1rem;
        }
      }
    </style>

    <script>
        // Course Registration JavaScript
        let selectedCourse = null;
        let currentStep = 1;
        let registrationData = {};

        // Course data
        const courses = {
            'group-learning': {
                name: 'Group Learning Program',
                price: 249,
                original: 399,
                description: '5 Days/Week ‚Ä¢ 20 Classes ‚Ä¢ Small Groups (Max 3)',
                paypalItemName: 'Group Learning Program - Monthly'
            },
            'flexible-learning': {
                name: 'Flexible Learning Program',
                price: 179,
                original: 299,
                description: '3 Days/Week ‚Ä¢ 12 Classes ‚Ä¢ Small Groups (Max 3)',
                paypalItemName: 'Flexible Learning Program - Monthly'
            },
            'one-on-one-intensive': {
                name: 'One-on-One Intensive Program',
                price: 399,
                original: 599,
                description: '5 Days/Week ‚Ä¢ 20 Private Sessions',
                paypalItemName: 'One-on-One Intensive Program - Monthly'
            },
            'personal-learning': {
                name: 'Personal Learning Program',
                price: 349,
                original: 499,
                description: '3 Days/Week ‚Ä¢ 12 Private Sessions',
                paypalItemName: 'Personal Learning Program - Monthly'
            }
        };

        // Initialize form
        document.addEventListener('DOMContentLoaded', function() {
            initializeForm();
        });

        function initializeForm() {
            // Course selection handlers
            document.querySelectorAll('.course-option').forEach(option => {
                option.addEventListener('click', function() {
                    selectCourse(this);
                });
            });

            // Step navigation
            document.getElementById('continueToStep2').addEventListener('click', goToStep2);
            document.getElementById('backToStep1').addEventListener('click', goToStep1);
            document.getElementById('continueToStep3').addEventListener('click', goToStep3);
            document.getElementById('backToStep2').addEventListener('click', goToStep2);
            document.getElementById('completeRegistration').addEventListener('click', completeRegistration);

            // Payment method selection
            document.querySelectorAll('input[name="paymentMethod"]').forEach(radio => {
                radio.addEventListener('change', handlePaymentMethodChange);
            });

            // Form validation
            document.getElementById('courseRegistrationForm').addEventListener('input', validateCurrentStep);
        }

        function selectCourse(courseElement) {
            // Remove previous selections
            document.querySelectorAll('.course-option').forEach(el => el.classList.remove('selected'));
            
            // Add selection to clicked course
            courseElement.classList.add('selected');
            
            // Store selected course data
            selectedCourse = courseElement.dataset.course;
            
            // Enable continue button
            document.getElementById('continueToStep2').disabled = false;
        }

        function goToStep1() {
            showStep(1);
        }

        function goToStep2() {
            if (selectedCourse) {
                updateCourseSummary();
                showStep(2);
            }
        }

        function goToStep3() {
            if (validateStep2()) {
                updateOrderSummary();
                showStep(3);
            }
        }

        function showStep(stepNumber) {
            // Hide all steps
            document.querySelectorAll('.form-step').forEach(step => {
                step.classList.remove('active');
            });
            
            // Show current step
            document.getElementById(`step${stepNumber}`).classList.add('active');
            currentStep = stepNumber;
            
            // Scroll to top
            window.scrollTo(0, 0);
        }

        function updateCourseSummary() {
            if (!selectedCourse) return;
            
            const course = courses[selectedCourse];
            const summaryHtml = `
                <div class="course-summary-card">
                    <h3>Selected Course: ${course.name}</h3>
                    <div class="summary-pricing">
                        <span class="summary-original">CAD $${course.original}</span>
                        <span class="summary-current">CAD $${course.price}/month</span>
                        <span class="summary-savings">Save $${course.original - course.price}!</span>
                    </div>
                    <p>${course.description}</p>
                </div>
            `;
            document.getElementById('selectedCourseSummary').innerHTML = summaryHtml;
        }

        function updateOrderSummary() {
            if (!selectedCourse) return;
            
            const course = courses[selectedCourse];
            const summaryHtml = `
                <div class="order-summary-card">
                    <h3>üìã Order Summary</h3>
                    <div class="order-item">
                        <div class="item-details">
                            <h4>${course.name}</h4>
                            <p>${course.description}</p>
                        </div>
                        <div class="item-pricing">
                            <div class="original-price">CAD $${course.original}</div>
                            <div class="current-price">CAD $${course.price}/month</div>
                            <div class="savings">Save $${course.original - course.price}!</div>
                        </div>
                    </div>
                    <div class="order-total">
                        <div class="total-line">
                            <span>Monthly Payment:</span>
                            <span class="total-amount">CAD $${course.price}</span>
                        </div>
                    </div>
                </div>
            `;
            document.getElementById('orderSummary').innerHTML = summaryHtml;
            
            // Update Interac amount
            document.getElementById('interacAmount').textContent = `CAD $${course.price}`;
        }

        function validateStep2() {
            const requiredFields = ['firstName', 'lastName', 'email', 'phone', 'frenchLevel', 'learningGoals', 'timeline'];
            return requiredFields.every(field => {
                const element = document.getElementById(field);
                return element && element.value.trim() !== '';
            });
        }

        function validateCurrentStep() {
            if (currentStep === 2) {
                document.getElementById('continueToStep3').disabled = !validateStep2();
            }
        }

        function handlePaymentMethodChange(event) {
            const method = event.target.value;
            
            // Hide all payment details
            document.querySelectorAll('.payment-details').forEach(detail => {
                detail.style.display = 'none';
            });
            
            // Show selected payment details
            document.getElementById(`${method}Details`).style.display = 'block';
            
            // Enable complete registration button
            document.getElementById('completeRegistration').disabled = false;
            
            // Update button text based on method
            const button = document.getElementById('completeRegistration');
            if (method === 'paypal') {
                button.innerHTML = '<i class="fas fa-credit-card"></i> Pay with PayPal';
            } else if (method === 'interac') {
                button.innerHTML = '<i class="fas fa-check"></i> Complete Registration';
            }
        }

        function completeRegistration() {
            const selectedPaymentMethod = document.querySelector('input[name="paymentMethod"]:checked');
            if (!selectedPaymentMethod) return;
            
            const method = selectedPaymentMethod.value;
            const course = courses[selectedCourse];
            
            // Collect form data
            registrationData = {
                course: selectedCourse,
                courseName: course.name,
                firstName: document.getElementById('firstName').value,
                lastName: document.getElementById('lastName').value,
                email: document.getElementById('email').value,
                phone: document.getElementById('phone').value,
                frenchLevel: document.getElementById('frenchLevel').value,
                learningGoals: document.getElementById('learningGoals').value,
                timeline: document.getElementById('timeline').value,
                specialRequests: document.getElementById('specialRequests').value,
                paymentMethod: method,
                amount: course.price,
                timestamp: new Date().toISOString()
            };
            
            if (method === 'paypal') {
                // First store data and send to WhatsApp, then proceed to PayPal
                storeDataAndProcessPayPal(registrationData, course);
            } else if (method === 'interac') {
                // For Interac, send to WhatsApp immediately
                sendRegistrationToWhatsApp(registrationData);
                // Show success message for Interac
                showSuccessMessage('interac');
            }
        }

        function storeDataAndProcessPayPal(regData, course) {
            // Simulate database storage (in real implementation, this would be an API call)
            localStorage.setItem('pendingRegistration', JSON.stringify(regData));
            
            // Send registration details to WhatsApp
            sendRegistrationToWhatsApp(regData);
            
            // Show processing message briefly
            showPayPalProcessingMessage(regData, course);
            
            // Proceed to PayPal after short delay to ensure WhatsApp opens
            setTimeout(() => {
                proceedToPayPal(regData, course);
            }, 2000);
        }

        function sendRegistrationToWhatsApp(regData) {
            const message = `üéì NEW COURSE REGISTRATION

üë§ Student: ${regData.firstName} ${regData.lastName}
üìß Email: ${regData.email}
üì± Phone: ${regData.phone}
üéØ Course: ${regData.courseName}
üí∞ Amount: CAD $${regData.amount}/month
üí≥ Payment Method: ${regData.paymentMethod.toUpperCase()}

üìä Student Details:
‚Ä¢ French Level: ${regData.frenchLevel}
‚Ä¢ Learning Goals: ${regData.learningGoals}
‚Ä¢ Timeline: ${regData.timeline}
${regData.specialRequests ? `‚Ä¢ Special Requests: ${regData.specialRequests}` : ''}

‚è∞ Registration Time: ${new Date().toLocaleString()}

${regData.paymentMethod === 'paypal' ? 'üí≥ PayPal payment in progress...' : 'üí∏ Waiting for Interac e-Transfer'}

Please process this registration. Thank you!`;

            const phoneNumber = "+13653062049";
            const whatsappURL = `https://wa.me/${phoneNumber}?text=${encodeURIComponent(message)}`;
            
            // Open WhatsApp in a new tab
            window.open(whatsappURL, '_blank');
        }

        function showPayPalProcessingMessage(regData, course) {
            document.querySelector('.registration-form-section').style.display = 'none';
            document.getElementById('successSection').style.display = 'block';
            
            const processingHtml = `
                <div class="success-details">
                    <div class="processing-animation">
                        <i class="fas fa-spinner fa-spin text-primary" style="font-size: 3rem; margin-bottom: 1rem;"></i>
                    </div>
                    <h3>üìù Registration Details Sent!</h3>
                    <p>Your registration details for <strong>${course.name}</strong> have been sent to our team via WhatsApp.</p>
                    <p>Redirecting you to PayPal for secure payment...</p>
                    
                    <div class="registration-summary" style="background: var(--neutral-50); padding: 1.5rem; border-radius: var(--radius-lg); margin: 1rem 0; text-align: left;">
                        <h4>üìã Registration Summary:</h4>
                        <p><strong>Student:</strong> ${regData.firstName} ${regData.lastName}</p>
                        <p><strong>Course:</strong> ${regData.courseName}</p>
                        <p><strong>Amount:</strong> CAD $${regData.amount}/month</p>
                        <p><strong>Email:</strong> ${regData.email}</p>
                    </div>
                </div>
            `;
            
            const nextStepsHtml = `
                <li><i class="fas fa-whatsapp text-success"></i> Registration details sent to our WhatsApp</li>
                <li><i class="fas fa-credit-card text-primary"></i> Complete your PayPal payment in the new window</li>
                <li><i class="fas fa-envelope"></i> You'll receive confirmation email with course details</li>
                <li><i class="fas fa-user-plus"></i> Our team will contact you within 24 hours to schedule classes</li>
            `;
            
            document.getElementById('successMessage').innerHTML = processingHtml;
            document.getElementById('nextStepsList').innerHTML = nextStepsHtml;
            
            // Scroll to top
            window.scrollTo(0, 0);
        }

        function proceedToPayPal(regData, course) {
            // Create PayPal URL with custom return URL that includes registration data
            const returnUrl = encodeURIComponent(`https://french.gta/course-registration.html?success=paypal&regId=${Date.now()}`);
            const cancelUrl = encodeURIComponent(`https://french.gta/course-registration.html?cancelled=true`);
            
            const paypalUrl = `https://www.paypal.com/cgi-bin/webscr?cmd=_xclick&business=phenish125@gmail.com&item_name=${encodeURIComponent(course.paypalItemName)}&amount=${course.price}&currency_code=CAD&return=${returnUrl}&cancel_return=${cancelUrl}&custom=${encodeURIComponent(JSON.stringify({email: regData.email, name: regData.firstName + ' ' + regData.lastName}))}`;
            
            // Open PayPal in the same window
            window.location.href = paypalUrl;
        }

        function showSuccessMessage(paymentMethod) {
            document.querySelector('.registration-form-section').style.display = 'none';
            document.getElementById('successSection').style.display = 'block';
            
            const course = courses[selectedCourse];
            let successHtml, nextStepsHtml;
            
            if (paymentMethod === 'paypal') {
                successHtml = `
                    <div class="success-details">
                        <h3>üéâ Payment Successful!</h3>
                        <p>Your PayPal payment has been processed and your registration for <strong>${course.name}</strong> is complete!</p>
                        
                        <div class="success-actions" style="margin: 2rem 0;">
                            <a href="https://wa.me/+13653062049?text=Hi%20FRENCH.GTA%2C%20I%20just%20completed%20my%20PayPal%20payment%20for%20${encodeURIComponent(course.name)}%20course.%20Please%20confirm%20my%20enrollment." target="_blank" class="btn btn-success btn-large">
                                <i class="fab fa-whatsapp"></i> Confirm Payment via WhatsApp
                            </a>
                        </div>
                    </div>
                `;
                nextStepsHtml = `
                    <li><i class="fas fa-check-circle text-success"></i> PayPal payment completed successfully</li>
                    <li><i class="fas fa-whatsapp text-success"></i> Click above to confirm payment via WhatsApp</li>
                    <li><i class="fas fa-envelope"></i> Check your email for course details and welcome information</li>
                    <li><i class="fas fa-calendar"></i> Our team will contact you within 24 hours to schedule your first class</li>
                    <li><i class="fas fa-graduation-cap"></i> Get ready to start your French learning journey!</li>
                `;
            } else {
                successHtml = `
                    <div class="success-details">
                        <h3>üìù Registration Received!</h3>
                        <p>Thank you for registering for <strong>${course.name}</strong>. Your details have been sent to our team via WhatsApp.</p>
                        <p>Please send your Interac e-Transfer to complete your enrollment.</p>
                        <div class="interac-reminder" style="background: var(--neutral-50); padding: 1.5rem; border-radius: var(--radius-lg); margin: 1rem 0;">
                            <h4>üí≥ e-Transfer Details:</h4>
                            <p><strong>Email:</strong> phenish125@gmail.com</p>
                            <p><strong>Amount:</strong> CAD $${course.price}</p>
                            <p><strong>Security Question:</strong> French Learning</p>
                            <p><strong>Answer:</strong> Success</p>
                            <p><strong>Message:</strong> ${course.name} - ${registrationData.firstName} ${registrationData.lastName}</p>
                        </div>
                    </div>
                `;
                nextStepsHtml = `
                    <li><i class="fas fa-whatsapp text-success"></i> Registration details sent to our WhatsApp</li>
                    <li><i class="fas fa-university"></i> Send your Interac e-Transfer using the details above</li>
                    <li><i class="fas fa-clock"></i> We'll confirm your payment within 24 hours</li>
                    <li><i class="fas fa-envelope"></i> You'll receive course details and schedule information</li>
                    <li><i class="fas fa-graduation-cap"></i> Start your French learning journey!</li>
                `;
            }
            
            document.getElementById('successMessage').innerHTML = successHtml;
            document.getElementById('nextStepsList').innerHTML = nextStepsHtml;
            
            // Scroll to top
            window.scrollTo(0, 0);
        }

        // Enhanced URL parameter handling for PayPal return
        document.addEventListener('DOMContentLoaded', function() {
            const urlParams = new URLSearchParams(window.location.search);
            
            if (urlParams.get('success') === 'paypal') {
                // PayPal payment successful
                const regId = urlParams.get('regId');
                
                // Try to get registration data from localStorage
                const pendingReg = localStorage.getItem('pendingRegistration');
                let regData = null;
                
                if (pendingReg) {
                    regData = JSON.parse(pendingReg);
                    // Clear the pending registration
                    localStorage.removeItem('pendingRegistration');
                }
                
                // Show PayPal success message
                document.querySelector('.registration-form-section').style.display = 'none';
                document.getElementById('successSection').style.display = 'block';
                
                const courseName = regData ? regData.courseName : 'French Course';
                const studentName = regData ? `${regData.firstName} ${regData.lastName}` : 'Student';
                
                const successHtml = `
                    <div class="success-details">
                        <div class="success-icon" style="text-align: center; margin-bottom: 2rem;">
                            <i class="fas fa-check-circle text-success" style="font-size: 4rem;"></i>
                        </div>
                        <h3>üéâ Payment Successful!</h3>
                        <p>Your PayPal payment has been processed successfully. Welcome to FRENCH.GTA, ${studentName}!</p>
                        <p>Your enrollment in <strong>${courseName}</strong> is now complete.</p>
                        
                        <div class="success-actions" style="margin: 2rem 0;">
                            <a href="https://wa.me/+13653062049?text=Hi%20FRENCH.GTA%2C%20I%20just%20completed%20my%20PayPal%20payment%20for%20${encodeURIComponent(courseName)}%20course.%20My%20name%20is%20${encodeURIComponent(studentName)}.%20Please%20confirm%20my%20enrollment%20and%20send%20me%20the%20course%20details." target="_blank" class="btn btn-success btn-large">
                                <i class="fab fa-whatsapp"></i> Confirm Payment via WhatsApp
                            </a>
                        </div>
                    </div>
                `;
                const nextStepsHtml = `
                    <li><i class="fas fa-check-circle text-success"></i> PayPal payment completed successfully</li>
                    <li><i class="fas fa-whatsapp text-success"></i> Click above to confirm payment via WhatsApp</li>
                    <li><i class="fas fa-envelope"></i> Check your email for course details and welcome information</li>
                    <li><i class="fas fa-calendar"></i> Our team will contact you within 24 hours to schedule your first class</li>
                    <li><i class="fas fa-graduation-cap"></i> Get ready to start your French learning journey!</li>
                `;
                
                document.getElementById('successMessage').innerHTML = successHtml;
                document.getElementById('nextStepsList').innerHTML = nextStepsHtml;
                
                // Send PayPal completion notification to WhatsApp if we have the data
                if (regData) {
                    setTimeout(() => {
                        sendPayPalCompletionToWhatsApp(regData);
                    }, 1000);
                }
            } else if (urlParams.get('cancelled') === 'true') {
                // PayPal payment cancelled
                document.querySelector('.registration-form-section').style.display = 'none';
                document.getElementById('successSection').style.display = 'block';
                
                const cancelledHtml = `
                    <div class="success-details">
                        <div class="cancelled-icon" style="text-align: center; margin-bottom: 2rem;">
                            <i class="fas fa-times-circle text-warning" style="font-size: 4rem;"></i>
                        </div>
                        <h3>‚ö†Ô∏è Payment Cancelled</h3>
                        <p>Your PayPal payment was cancelled. Don't worry, your registration details have been saved.</p>
                        
                        <div class="retry-actions" style="margin: 2rem 0;">
                            <button onclick="window.location.reload()" class="btn btn-primary btn-large">
                                <i class="fas fa-redo"></i> Try Payment Again
                            </button>
                            <a href="https://wa.me/+13653062049?text=Hi%20FRENCH.GTA%2C%20I%20had%20an%20issue%20with%20my%20PayPal%20payment.%20Can%20you%20help%20me%20complete%20my%20course%20registration%3F" target="_blank" class="btn btn-secondary btn-large">
                                <i class="fab fa-whatsapp"></i> Get Help via WhatsApp
                            </a>
                        </div>
                    </div>
                `;
                const nextStepsHtml = `
                    <li><i class="fas fa-redo"></i> Click "Try Payment Again" to retry your PayPal payment</li>
                    <li><i class="fas fa-whatsapp"></i> Contact us via WhatsApp if you need assistance</li>
                    <li><i class="fas fa-university"></i> Alternatively, you can choose Interac e-Transfer payment method</li>
                `;
                
                document.getElementById('successMessage').innerHTML = cancelledHtml;
                document.getElementById('nextStepsList').innerHTML = nextStepsHtml;
            }
        });

        function sendPayPalCompletionToWhatsApp(regData) {
            const message = `‚úÖ PAYPAL PAYMENT COMPLETED

üë§ Student: ${regData.firstName} ${regData.lastName}
üìß Email: ${regData.email}
üéØ Course: ${regData.courseName}
üí∞ Amount: CAD $${regData.amount}/month
üí≥ Payment Method: PayPal ‚úÖ

Registration is now COMPLETE. Please:
1. Send course details to student
2. Schedule first class
3. Add to course management system

‚è∞ Payment completed: ${new Date().toLocaleString()}`;

            const phoneNumber = "+13653062049";
            const whatsappURL = `https://wa.me/${phoneNumber}?text=${encodeURIComponent(message)}`;
            
            // Open WhatsApp in a new tab
            window.open(whatsappURL, '_blank');
        }
    </script>
</body>
</html> 